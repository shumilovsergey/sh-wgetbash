{% extends 'base.html' %}
{% block title %}
wgetbash
{% endblock %}
{% block content %}
{% load static %}





<div class="flex justify-evenly">
    <div class="menu">
        <div>Доступные скрипты:</div>
        <div id="menu-items">
            {% for item in menu_items %}
                <div>
                    <button class="menu-item" onclick="moveToOrder(this)">{{ item }}</button>
                </div>
                    
            {% endfor %}
        </div>
    </div>
    <div class="order">
        <div>Шаблон:</div>
        <div>
            <button id="order-items"></button>
        </div>
        <div id="order-items"></div>

        <div class="comment">
            <label for="comment">Comment:</label>
            <input type="text" id="comment" placeholder="Enter your comment">
        </div>

        <button id="order-btn">Ok</button>
    </div>
</div>

<script>
    function moveToOrder(menuItem) {
        const orderContainer = document.getElementById('order-items');
        const orderItem = document.createElement('div');
        orderItem.className = 'order-item';
        orderItem.textContent = menuItem.textContent;
        orderItem.onclick = () => moveToMenu(orderItem);
        orderContainer.appendChild(orderItem);
        menuItem.remove();
    }

    function moveToMenu(orderItem) {
        const menuContainer = document.getElementById('menu-items');
        const menuItem = document.createElement('div');
        menuItem.className = 'menu-item';
        menuItem.textContent = orderItem.textContent;
        menuItem.onclick = () => moveToOrder(menuItem);
        menuContainer.appendChild(menuItem);
        orderItem.remove();
    }

    document.getElementById('order-btn').onclick = () => {
        const orderItems = document.querySelectorAll('#order-items .order-item');
        const orderList = Array.from(orderItems).map(item => item.textContent);
        const comment = document.getElementById('comment').value;
        fetch('/submit_order/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({ order: orderList, comment: comment })
        })
        .then(response => response.json())
        .then(data => {
            console.log('Order submitted:', data);
        });
    };

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

{% endblock %}